<!DOCTYPE html>
<html lang="en-us">
  <head>
    <title>Tasklet | Sukbeom Kim</title>

    <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">    
<meta name="viewport" content="width=device-width,minimum-scale=1">
<meta name="description" content="ê°œìš” ğŸ”—ì‚¬ë‚´ ì»¤ë„ ìŠ¤í„°ë””ì—ì„œ êµì¬ë¡œì„œ ì‚¬ìš©í•˜ê³  ìˆëŠ” ë””ë²„ê¹…ì„ í†µí•´ ë°°ìš°ëŠ” ë¦¬ëˆ…ìŠ¤ ì»¤ë„ì˜ êµ¬ì¡°ì™€ ì›ë¦¬ ì±…ì—ì„œëŠ” íƒœìŠ¤í¬ë¦¿ (Tasklet)ì„ SoftIRQì™€ í•¨ê»˜">
<meta name="generator" content="Hugo 0.121.2">


  <META NAME="ROBOTS" CONTENT="NOINDEX, NOFOLLOW">


<link rel="stylesheet" href="/css/style.css">


  
    
    <link rel="stylesheet" href="https://seokbeomkim.github.iocss/img.css">
  

  
    
    <link rel="stylesheet" href="https://seokbeomkim.github.iocss/noto_sans_kr.css">
  

  
    
    <link rel="stylesheet" href="https://seokbeomkim.github.iocss/nanumgothic.css">
  


<link rel="shortcut icon" href="/images/favicon.ico" type="image/x-icon" />

 
    
<script>
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'G-Y7VW74D2P3', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>




  
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.13/dist/katex.min.css" integrity="sha384-RZU/ijkSsFbcmivfdRBQDtwuwVqK7GMOw6IMvKyeWL2K5UAlyp6WonmB8m7Jd0Hn" crossorigin="anonymous">
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.13.13/dist/katex.min.js" integrity="sha384-pK1WpvzWVBQiP0/GjnvRxV4mOb0oxFuyRxJlk6vVw146n3egcN5C925NCP7a7BY8" crossorigin="anonymous"></script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.13.13/dist/contrib/auto-render.min.js" integrity="sha384-vZTG03m+2yp6N6BNi5iM4rW4oIwk5DfcNdFfxkk9ZWpDriOkXX8voJBFrAO7MpVl" crossorigin="anonymous"
    onload="renderMathInElement(document.body);"></script>




  </head>

  <body>
    <nav class="navigation">
	
		<a href="/"> <span class="arrow">â†</span>Home</a>
	
	<a href="/posts">Archive</a>
	<a href="/tags">Tags</a>
	<a href="/about">About</a>

	

	
	  <a class="button" href="https://seokbeomkim.github.io/index.xml">Subscribe</a>
	
</nav>


    <main class="main">
      

<section id="single">
    <h1 class="title">Tasklet</h1>

    <div class="tip">
        <time datetime="2022-11-13 17:32:26 &#43;0900 KST">Nov 13, 2022</time>
        <span class="split">
          Â·
        </span>
        <span>
          1130 words
        </span>
        <span class="split">
          Â·
        </span>
        <span>
          3 minute read
        </span>
    </div>

    
    
        
  


    


    <div class="content">
      <h1 id="ê°œìš”">ê°œìš” <a href="#%ea%b0%9c%ec%9a%94" class="anchor">ğŸ”—</a></h1><p>ì‚¬ë‚´ ì»¤ë„ ìŠ¤í„°ë””ì—ì„œ êµì¬ë¡œì„œ ì‚¬ìš©í•˜ê³  ìˆëŠ” ë””ë²„ê¹…ì„ í†µí•´ ë°°ìš°ëŠ” ë¦¬ëˆ…ìŠ¤ ì»¤ë„ì˜
êµ¬ì¡°ì™€ ì›ë¦¬ ì±…ì—ì„œëŠ” íƒœìŠ¤í¬ë¦¿ (Tasklet)ì„ SoftIRQì™€ í•¨ê»˜ ì•„ë˜ì™€ ê°™ì´ ì„¤ëª…í•œë‹¤.</p>
<p>SoftIRQ ì„œë¹„ìŠ¤ ì¤‘ í•˜ë‚˜ë¡œ ë™ì ìœ¼ë¡œ Soft IRQ ì„œë¹„ìŠ¤ë¥¼ ì“¸ ìˆ˜ ìˆëŠ” ì¸í„°í˜ì´ìŠ¤ì´ë‹¤.
ê·¸ë¦¬ê³  ì´ì™€ í•¨ê»˜ Taskletì˜ ì‹¤í–‰ ë‹¨ê³„ì— ëŒ€í•œ ë‚´ìš©ì´ ìì„¸í•˜ê²Œ ê¸°ìˆ ë˜ì–´ ìˆë‹¤.</p>
<p>ì¸í„°ëŸ½íŠ¸ í•¸ë“¤ëŸ¬ì—ì„œ task_schedule() í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•´ íƒœìŠ¤í¬ë¦¿ ìŠ¤ì¼€ì¥´ë§ì„ ì‹¤í–‰í•œë‹¤.
task_schedule() í•¨ìˆ˜ëŠ” raise_softirq_irqoff() í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•´ TASKLET Soft IRQ
ì„œë¹„ìŠ¤ë¥¼ ìš”ì²­í•œë‹¤. Soft IRQ ì„œë¹„ìŠ¤ í•¸ë“¤ëŸ¬ë¥¼ í˜¸ì¶œí•˜ëŠ” __do_softirq() í•¨ìˆ˜ì—ì„œ
íƒœìŠ¤í¬ë¦¿ ì„œë¹„ìŠ¤ í•¸ë“¤ëŸ¬ì¸ tasklet_action() í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•œë‹¤. Soft IRQ ì„œë¹„ìŠ¤
í•¸ë“¤ëŸ¬ë¥¼ ì‹¤í–‰í•œ í›„ ì‹¤í–‰ ì‹œê°„ì„ ì²´í¬í•´ ksoftirqd ë¥¼ ê¹¨ìš°ê³  ì‹¤í–‰ì„ ë§ˆë¬´ë¦¬í•œë‹¤.
ksoftirqd ìŠ¤ë ˆë“œì—ì„œ íƒœìŠ¤í¬ë¦¿ ì„œë¹„ìŠ¤ í•¸ë“¤ëŸ¬ì¸ tasklet_action() í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•œë‹¤.
tasklet_action() í•¨ìˆ˜ì—ì„œ íƒœìŠ¤í¬ë¦¿ í•¸ë“¤ëŸ¬ í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•œë‹¤. ì±…ì—ì„œëŠ” SoftIRQë¥¼
ì¸í„°ëŸ½íŠ¸ í›„ë°˜ë¶€ë¥¼ ë¹¨ë¦¬ ì²˜ë¦¬í•´ì•¼ í•  ë•Œ ì‚¬ìš©í•˜ëŠ” ê¸°ë²•ìœ¼ë¡œ ì„¤ëª…í•˜ê³  ìˆê³  ë””ë°”ì´ìŠ¤
ë“œë¼ì´ë²„ì—ì„œ SoftIRQë¥¼ ì‚¬ìš©í•˜ëŠ” ë°©ë²•ìœ¼ë¡œì„œ Tasklet ì„œë¹„ìŠ¤ë¥¼ ì„¤ëª…í•˜ê³  ìˆë‹¤.
ê·¸ëŸ°ë° ì˜ˆì „ ì†ŒìŠ¤ ì½”ë“œ ê¸°ë°˜ì´ë¼ ê·¸ëŸ°ì§€ ì°¾ì•„ë³¸ ë‚´ìš©ê³¼ ë‹¤ë¥¸ ë¶€ë¶„ì´ ìˆë‹¤. ìµœì‹ 
ì½”ë“œë¥¼ ê¸°ì¤€ìœ¼ë¡œ ì°¾ì•„ë³´ë©´ taskletì— ëŒ€í•´ ì•„ë˜ì™€ ê°™ì´ ì„¤ëª…í•œë‹¤.</p>
<p>/* Tasklets &mdash; multithreaded analogue of BHs.</p>
<p>This API is deprecated. Please consider using threaded IRQs instead:
<a href="https://lore.kernel.org/lkml/20200716081538.2sivhkj4hcyrusem@linutronix.de" target="_blank" rel="noopener">https://lore.kernel.org/lkml/20200716081538.2sivhkj4hcyrusem@linutronix.de</a></p>
<p>Main feature differing them of generic softirqs: tasklet
is running only on one CPU simultaneously.</p>
<p>Main feature differing them of BHs: different tasklets
may be run simultaneously on different CPUs.</p>
<p>Properties:</p>
<ul>
<li>If tasklet_schedule() is called, then tasklet is guaranteed
to be executed on some cpu at least once after this.</li>
<li>If the tasklet is already scheduled, but its execution is still not
started, it will be executed only once.</li>
<li>If this tasklet is already running on another CPU (or schedule is called
from tasklet itself), it is rescheduled for later.</li>
<li>Tasklet is strictly serialized wrt itself, but not
wrt another tasklets. If client needs some intertask synchronization,
he makes it with spinlocks.
*/</li>
</ul>
<p>$linux/include/linux/interrupt.h</p>
<p>ì½”ë“œì—ì„œëŠ” íƒœìŠ¤í¬ë¦¿ ëŒ€ì‹  Threaded IRQë¥¼ ì‚¬ìš©í•  ê²ƒì„ ê¶Œí•œë‹¤. ì½”ë©˜íŠ¸ì˜ ë§í¬ë¥¼
ë”°ë¼ê°€ë³´ë©´ íƒœìŠ¤í¬ë¦¿ ë§¤í¬ë¡œë¥¼ ìˆ˜ì •í•œ ê±´ì— ëŒ€í•œ íŒ¨ì¹˜ì—ì„œ íƒœìŠ¤í¬ë¦¿ì„ ë³„ë„ì˜
ì‘ì—…(refactor all tasklet users into other APIs Â· Issue #94 Â· KSPP/linux)ìœ¼ë¡œ
ì œê±°í•˜ìëŠ” ì–˜ê¸°ê°€ ë‚˜ì˜¨ë‹¤. ë…¼ì˜ ë‚´ìš©ì„ ì˜ ì •ë¦¬í•œ LWN ê¸°ì‚¬(Modernizing the tasklet
API [LWN.net]) ë„ ì°¾ì„ ìˆ˜ ìˆì—ˆëŠ”ë° ê°„ë‹¨í•˜ê²Œ ì •ë¦¬í•´ë³´ë©´ ì•„ë˜ì™€ ê°™ë‹¤.</p>
<p>Threaded IRQ ë„ atomic contextì—ì„œ ì‹¤í–‰ë˜ë¯€ë¡œ taskletì„ ëŒ€ì²´ë  ìˆ˜ ìˆë‹¤. ì½”ì–´
ê°œë°œìë“¤ë„ íƒœìŠ¤í¬ë¦¿ì˜ APIë¥¼ ê°œì„ í•˜ëŠ” ê²ƒë³´ë‹¤ ì œê±°í•˜ëŠ” ê²Œ ë” í° ì‘ì—…ì´ì§€ë§Œ next
step ìœ¼ë¡œ ì œê±°í•˜ëŠ” ë°ì—ëŠ” ë™ì˜í•˜ì˜€ë‹¤. LWN ì—ì„œ ì´ì „ì— ë‹¤ë£¬ ë‚´ìš©ì´ì§€ë§Œ íƒœìŠ¤í¬ë¦¿ì€
software interrupt modeì—ì„œ ì‹¤í–‰ë˜ê¸° ë•Œë¬¸ì— ë‹¤ë¥¸ highest-priority íƒœìŠ¤í¬ë“¤ì„
ë¸”ë¡í•  ìˆ˜ ìˆëŠ” latency ì œí•œ ë¬¸ì œê°€ ìˆë‹¤. Taskletì€ workqueues, timers, threaded
interruptsë¡œ ëŒ€ì²´ ê°€ëŠ¥í•˜ë‹¤. Threaded irqë¥¼ ì‚¬ìš©í•˜ë©´ ì¸í„°ëŸ½íŠ¸ í•¸ë“¤ëŸ¬ ìì²´ì—ì„œ
ì‹¤í–‰ë  ìˆ˜ ìˆë‹¤. ê·¸ë¦¬ê³  ì´ëŸ¬í•œ ì‹ ê·œ ë§¤ì»¤ë‹ˆì¦˜ë“¤ì€ íƒœìŠ¤í¬ë¦¿ì˜ ë‹¨ì ë“¤ì´ ì—†ê¸° ë•Œë¬¸ì—
êµ³ì´(?) ê°œë°œìë“¤ì´ tasklet ì„ ì“¸ ì´ìœ ê°€ ì—†ë‹¤. ê²°ë¡ ì ìœ¼ë¡œ íƒœìŠ¤í¬ë¦¿ì„ ê¼­
ì¨ì•¼í•œë‹¤ë©´ ì–´ì©” ìˆ˜ ì—†ê² ì§€ë§Œ ì´í›„ì— ìƒˆë¡œ ë‚˜ì˜¨ ë°©ë²•ë“¤ë¡œë„ ì¶©ë¶„íˆ BH ë¥¼ ë‹¤ë£° ìˆ˜
ìˆìœ¼ë©° ì´ëŸ¬í•œ ë°©ë²•ì„ ì œì™¸í•˜ê³  êµ³ì´ ì¨ì•¼í•˜ëŠ” ì´ìœ ëŠ” ì—†ë‹¤ëŠ” ê²ƒì´ë‹¤. íƒœìŠ¤í¬ë¦¿ì„
ë°˜ë“œì‹œ ì¨ì•¼ í•˜ëŠ” ê²½ìš°ë¥¼ íŒë‹¨í•´ì•¼ í•œë‹¤ë©´ ì•„ë˜ ë§í¬ë“¤ê³¼ êµì¬ ë‚´ìš©ì„ í•¨ê»˜
ì°¸ê³ í•´ë³´ì.</p>
<h1 id="ì°¸ê³ ">ì°¸ê³  <a href="#%ec%b0%b8%ea%b3%a0" class="anchor">ğŸ”—</a></h1><ul>
<li>Modernizing the tasklet API [LWN.net]</li>
<li>Re: [PATCH 0/3] Modernize tasklet callback API - Allen (kernel.org)</li>
</ul>

    </div>

    
        <div class="tags">
            
                <a href="https://seokbeomkim.github.io/tags/tasklet">tasklet</a>
            
        </div>
    
    
    

</section>


    </main>
    
    <footer id="footer">
    

    <div class="copyright">
    
        Copyright - Sukbeom Kim
    
    </div>

    
</footer>



  </body>
</html>
