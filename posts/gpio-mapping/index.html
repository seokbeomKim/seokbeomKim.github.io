<!DOCTYPE html>
<html lang="en-us">
  <head>
    <title>GPIO Mapping | Sukbeom Kim</title>

    <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">    
<meta name="viewport" content="width=device-width,minimum-scale=1">
<meta name="description" content="GPIO ë§µí•‘í•˜ê¸° ğŸ”—ì˜¤ëŠ˜ì€ gpio ë§µí•‘ì„ ìœ„í•´ ë””ë°”ì´ìŠ¤ íŠ¸ë¦¬ë¥¼ ì´ìš©í•˜ì˜€ì§€ë§Œ ì •ìƒì ìœ¼ë¡œ ì„¤ì •ë˜ì§€ ì•ŠëŠ” ë¬¸ì œê°€ ìˆì—ˆë‹¤. SoCì—ì„œ GPIO Enable ì— ëŒ€í•œ ê²ƒì´ ë¬¸ì œì¼ ê²ƒì´ë¼ ì˜ˆìƒë˜ì§€ë§Œ,">
<meta name="generator" content="Hugo 0.121.2">


  <META NAME="ROBOTS" CONTENT="NOINDEX, NOFOLLOW">


<link rel="stylesheet" href="/css/style.css">


  
    
    <link rel="stylesheet" href="/css/img.css">
  

  
    
    <link rel="stylesheet" href="/css/noto_sans_kr.css">
  

  
    
    <link rel="stylesheet" href="/css/nanumgothic.css">
  


<link rel="shortcut icon" href="/images/favicon.ico" type="image/x-icon" />

 
    
<script>
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'G-Y7VW74D2P3', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>




  
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.13/dist/katex.min.css" integrity="sha384-RZU/ijkSsFbcmivfdRBQDtwuwVqK7GMOw6IMvKyeWL2K5UAlyp6WonmB8m7Jd0Hn" crossorigin="anonymous">
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.13.13/dist/katex.min.js" integrity="sha384-pK1WpvzWVBQiP0/GjnvRxV4mOb0oxFuyRxJlk6vVw146n3egcN5C925NCP7a7BY8" crossorigin="anonymous"></script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.13.13/dist/contrib/auto-render.min.js" integrity="sha384-vZTG03m+2yp6N6BNi5iM4rW4oIwk5DfcNdFfxkk9ZWpDriOkXX8voJBFrAO7MpVl" crossorigin="anonymous"
    onload="renderMathInElement(document.body);"></script>




  </head>

  <body>
    <nav class="navigation">
	
		<a href="/"> <span class="arrow">â†</span>Home</a>
	
	<a href="/posts">Archive</a>
	<a href="/tags">Tags</a>
	<a href="/about">About</a>

	

	
	  <a class="button" href="/index.xml">Subscribe</a>
	
</nav>


    <main class="main">
      

<section id="single">
    <h1 class="title">GPIO Mapping</h1>

    <div class="tip">
        <time datetime="2020-01-31 23:48:06 &#43;0900 KST">Jan 31, 2020</time>
        <span class="split">
          Â·
        </span>
        <span>
          1087 words
        </span>
        <span class="split">
          Â·
        </span>
        <span>
          3 minute read
        </span>
    </div>

    
    
        
  
    <aside class="toc">
      <details>
          <summary>Table of Contents
          </summary>
          <div>
              <nav id="TableOfContents">
  <ul>
    <li><a href="#cell-ê°œìˆ˜">cell ê°œìˆ˜</a></li>
    <li><a href="#pin-control-subsystemê³¼ì˜-ì—°ë™">Pin control subsystemê³¼ì˜ ì—°ë™</a></li>
  </ul>
</nav>
          </div>
      </details>
    </aside>
  


    


    <div class="content">
      <h1 id="gpio-ë§µí•‘í•˜ê¸°">GPIO ë§µí•‘í•˜ê¸° <a href="#gpio-%eb%a7%b5%ed%95%91%ed%95%98%ea%b8%b0" class="anchor">ğŸ”—</a></h1><p>ì˜¤ëŠ˜ì€ gpio ë§µí•‘ì„ ìœ„í•´ ë””ë°”ì´ìŠ¤ íŠ¸ë¦¬ë¥¼ ì´ìš©í•˜ì˜€ì§€ë§Œ ì •ìƒì ìœ¼ë¡œ ì„¤ì •ë˜ì§€ ì•ŠëŠ” ë¬¸ì œê°€ ìˆì—ˆë‹¤. SoCì—ì„œ GPIO Enable ì— ëŒ€í•œ ê²ƒì´ ë¬¸ì œì¼ ê²ƒì´ë¼ ì˜ˆìƒë˜ì§€ë§Œ, GPIO ë§µí•‘í•˜ëŠ” ë°©ë²•ìœ¼ë¡œ ë””ë°”ì´ìŠ¤ íŠ¸ë¦¬ë¥¼ ì´ìš©í•˜ëŠ” ê²ƒ ì™¸ì— ì–´ë–¤ ëŒ€ì•ˆì´ ìˆëŠ”ì§€ ì•Œì•„ë³´ê³ ì ì •ë¦¬í•˜ê³ ì í•œë‹¤.</p>
<p>GPIO ë°ì´í„°ë¥¼ ë§µí•‘í•˜ì—¬ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” ë°©ë²•ì€ ì•„ë˜ì™€ ê°™ì´ ì„¸ ê°€ì§€ ë°©ë²•ì´ ìˆë‹¤.</p>
<ol>
<li>ë””ë°”ì´ìŠ¤ íŠ¸ë¦¬ ì´ìš© (ìµœê·¼ íŠ¸ë Œë“œ)</li>
<li>Legacy Board &amp; Machine Specific Codeì—ì„œ í”Œë«í¼ ë°ì´í„°ë¡œ ì •ì˜</li>
</ol>
<ul>
<li>(ì¶œì²˜ì— ë”°ë¥´ë©´) GPIO ë§µí•‘ì„ í”Œë«í¼ ë°ì´í„°ì— ë“±ë¡í•˜ì—¬ ì‚¬ìš©í•˜ëŠ” ê²½ìš°ëŠ” ë§ì§€ ì•Šê³  ë‹¨ìˆœí•˜ê²Œ í•€ ë²ˆí˜¸ë¡œ ì‚¬ìš©í•˜ëŠ” ê²½ìš°ê°€ ëŒ€ë¶€ë¶„ì´ì—ˆë‹¤ê³  í•œë‹¤.</li>
</ul>
<ol start="3">
<li>ACPI íŒì›¨ì–´ í…Œì´ë¸”ì— ì •ì˜</li>
</ol>
<h1 id="ë””ë°”ì´ìŠ¤-íŠ¸ë¦¬ë¥¼-ì‚¬ìš©í•˜ëŠ”-gpio-ë§¤í•‘">ë””ë°”ì´ìŠ¤ íŠ¸ë¦¬ë¥¼ ì‚¬ìš©í•˜ëŠ” GPIO ë§¤í•‘ <a href="#%eb%94%94%eb%b0%94%ec%9d%b4%ec%8a%a4-%ed%8a%b8%eb%a6%ac%eb%a5%bc-%ec%82%ac%ec%9a%a9%ed%95%98%eb%8a%94-gpio-%eb%a7%a4%ed%95%91" class="anchor">ğŸ”—</a></h1><p>ë””ë°”ì´ìŠ¤ ë…¸ë“œ ë‚´ë¶€ì— &ldquo;gpio-controller&rdquo; ì†ì„±ì´ ìˆìœ¼ë©´ GPIO Controller ë…¸ë“œë¥¼ ì˜ë¯¸í•œë‹¤.</p>
<h2 id="cell-ê°œìˆ˜">cell ê°œìˆ˜ <a href="#cell-%ea%b0%9c%ec%88%98" class="anchor">ğŸ”—</a></h2><p><code>#gpio-cells = &lt;2&gt;</code> ì†ì„±ì€ ì…€ ë°ì´í„° 2ê°œë¥¼ ì‚¬ìš©í•œë‹¤ëŠ” ê²ƒì„ ì˜ë¯¸í•œë‹¤. ì•„ë˜ ì˜ˆì‹œì—ì„œëŠ” gpio1, gpio2ì— ëŒ€í•´ ê°ê° ë‹¤ìŒê³¼ ê°™ì´ í•´ì„ ê°€ëŠ¥í•˜ë‹¤.</p>
<ul>
<li>gpio1 controllerëŠ” cell 2ê°œë¥¼ ì‚¬ìš©í•˜ì—¬ ë””ë°”ì´ìŠ¤ ë“œë¼ì´ë²„ê°€ ì¸ì 2ê°œë¥¼ ë°›ì•„ ì²˜ë¦¬í•œë‹¤.</li>
<li>gpio2 controllerëŠ” cell 1ê°œë¥¼ ì‚¬ìš©í•˜ì—¬ ë””ë°”ì´ìŠ¤ ë“œë¼ì´ë²„ê°€ ì¸ì 1ê°œë¥¼ ë°›ì•„ ì²˜ë¦¬í•œë‹¤.</li>
<li>ì§€ì •ë˜ì§€ ì•ŠëŠ” ê²½ìš° 2 cell ë°©ì‹ì„ ì‚¬ìš©í•œë‹¤.</li>
</ul>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>gpio1: gpio1 {
</span></span><span style="display:flex;"><span>    gpio-controller;
</span></span><span style="display:flex;"><span>    #gpio-cells = &lt;2&gt;;
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span>gpio2: gpio2 {
</span></span><span style="display:flex;"><span>    gpio-controller;
</span></span><span style="display:flex;"><span>    #gpio-cells = &lt;1&gt;;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>enable-gpios = &lt;&amp;gpio2 2&gt;;
</span></span><span style="display:flex;"><span>data-gpios = &lt;&amp;gpio1 12 0&gt;, &lt;&amp;gpio1 13 0&gt;, &lt;&amp;gpio1 14 0&gt;, &lt;&amp;gpio1 15 0&gt;;
</span></span></code></pre></div><h2 id="pin-control-subsystemê³¼ì˜-ì—°ë™">Pin control subsystemê³¼ì˜ ì—°ë™ <a href="#pin-control-subsystem%ea%b3%bc%ec%9d%98-%ec%97%b0%eb%8f%99" class="anchor">ğŸ”—</a></h2><p><code>pin control subsystem</code>ê³¼ì˜ ì—°ë™ì€ gpio controller ë…¸ë“œì—ì„œ &ldquo;gpio-ranges&rdquo; ì†ì„±ì„ ì‚¬ìš©í•œë‹¤.
&ldquo;gpio-ranges&rdquo; ì†ì„±ì´ ê°€ë¦¬í‚¤ëŠ” phandleì€ ì—°ê³„ëœ pin controller ë…¸ë“œë¥¼ ê°€ë¦¬ì¼œì•¼ í•œë‹¤. ê·¸ë¦¬ê³  1~3ê°œì˜ ì¸ìë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆìœ¼ë©°, ë°°ì—´ ì‚¬ìš©ì„ ì§€ì›í•œë‹¤.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>iomux: iomux@FF10601c {
</span></span><span style="display:flex;"><span>        compatible = &#34;abilis,tb10x-iomux&#34;;
</span></span><span style="display:flex;"><span>        reg = &lt;0xFF10601c 0x4&gt;;
</span></span><span style="display:flex;"><span>        pctl_gpio_a: pctl-gpio-a {
</span></span><span style="display:flex;"><span>                abilis,function = &#34;gpioa&#34;;
</span></span><span style="display:flex;"><span>        };
</span></span><span style="display:flex;"><span>        pctl_uart0: pctl-uart0 {
</span></span><span style="display:flex;"><span>                abilis,function = &#34;uart0&#34;;
</span></span><span style="display:flex;"><span>        };
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span>uart@FF100000 {
</span></span><span style="display:flex;"><span>        compatible = &#34;snps,dw-apb-uart&#34;;
</span></span><span style="display:flex;"><span>        reg = &lt;0xFF100000 0x100&gt;;
</span></span><span style="display:flex;"><span>        clock-frequency = &lt;166666666&gt;;
</span></span><span style="display:flex;"><span>        interrupts = &lt;25 1&gt;;
</span></span><span style="display:flex;"><span>        reg-shift = &lt;2&gt;;
</span></span><span style="display:flex;"><span>        reg-io-width = &lt;4&gt;;
</span></span><span style="display:flex;"><span>        pinctrl-names = &#34;default&#34;;
</span></span><span style="display:flex;"><span>        pinctrl-0 = &lt;&amp;pctl_uart0&gt;;
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span>gpioa: gpio@FF140000 {
</span></span><span style="display:flex;"><span>        compatible = &#34;abilis,tb10x-gpio&#34;;
</span></span><span style="display:flex;"><span>        reg = &lt;0xFF140000 0x1000&gt;;
</span></span><span style="display:flex;"><span>        gpio-controller;
</span></span><span style="display:flex;"><span>        #gpio-cells = &lt;2&gt;;
</span></span><span style="display:flex;"><span>        ngpios = &lt;3&gt;;
</span></span><span style="display:flex;"><span>        gpio-ranges = &lt;&amp;iomux 0 0&gt;;
</span></span><span style="display:flex;"><span>        gpio-ranges-group-names = &#34;gpioa&#34;;
</span></span><span style="display:flex;"><span>};
</span></span></code></pre></div><h1 id="acpi-íŒì›¨ì–´ë¥¼-ì‚¬ìš©í•˜ëŠ”-gpio-ë§¤í•‘">ACPI íŒì›¨ì–´ë¥¼ ì‚¬ìš©í•˜ëŠ” GPIO ë§¤í•‘ <a href="#acpi-%ed%8e%8c%ec%9b%a8%ec%96%b4%eb%a5%bc-%ec%82%ac%ec%9a%a9%ed%95%98%eb%8a%94-gpio-%eb%a7%a4%ed%95%91" class="anchor">ğŸ”—</a></h1><p>ë””ë°”ì´ìŠ¤ íŠ¸ë¦¬ë¥¼ ì‚¬ìš©í•˜ëŠ” ë°©ë²•ê³¼ ìœ ì‚¬í•˜ê²Œ ACPI ë””ìŠ¤í¬ë¦½ì…˜ì„ ì‚¬ìš©í•˜ëŠ” ë°©ë²•ì´ ìˆë‹¤. ACPI 5.1ì—ì„œ ì†Œê°œëœ [[[_DSD (Device Specific Data)|https://www.kernel.org/doc/Documentation/acpi/gpio-properties.txt]]ë¥¼ ì°¸ê³ í•œë‹¤.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>Device (FOO) {
</span></span><span style="display:flex;"><span>    Name (_CRS, ResourceTemplate () {
</span></span><span style="display:flex;"><span>        GpioIo (Exclusive, ..., IoRestrictionOutputOnly,
</span></span><span style="display:flex;"><span>            &#34;\\_SB.GPI0&#34;) {15} // red
</span></span><span style="display:flex;"><span>        GpioIo (Exclusive, ..., IoRestrictionOutputOnly,
</span></span><span style="display:flex;"><span>            &#34;\\_SB.GPI0&#34;) {16} // green
</span></span><span style="display:flex;"><span>        GpioIo (Exclusive, ..., IoRestrictionOutputOnly,
</span></span><span style="display:flex;"><span>            &#34;\\_SB.GPI0&#34;) {17} // blue
</span></span><span style="display:flex;"><span>        GpioIo (Exclusive, ..., IoRestrictionOutputOnly,
</span></span><span style="display:flex;"><span>            &#34;\\_SB.GPI0&#34;) {1} // power
</span></span><span style="display:flex;"><span>    })
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    Name (_DSD, Package () {
</span></span><span style="display:flex;"><span>        ToUUID(&#34;daffd814-6eba-4d8c-8a91-bc9bbf4aa301&#34;),
</span></span><span style="display:flex;"><span>        Package () {
</span></span><span style="display:flex;"><span>            Package () {
</span></span><span style="display:flex;"><span>                &#34;led-gpios&#34;,
</span></span><span style="display:flex;"><span>                Package () {
</span></span><span style="display:flex;"><span>                    ^FOO, 0, 0, 1,
</span></span><span style="display:flex;"><span>                    ^FOO, 1, 0, 1,
</span></span><span style="display:flex;"><span>                    ^FOO, 2, 0, 1,
</span></span><span style="display:flex;"><span>                }
</span></span><span style="display:flex;"><span>            },
</span></span><span style="display:flex;"><span>            Package () {
</span></span><span style="display:flex;"><span>                &#34;power-gpios&#34;,
</span></span><span style="display:flex;"><span>                Package () {^FOO, 3, 0, 0},
</span></span><span style="display:flex;"><span>            },
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    })    Name (_CRS, )
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h1 id="platform-ë°ì´í„°ì—-gpio-ë§µí•‘-deprecated">Platform ë°ì´í„°ì— GPIO ë§µí•‘ (deprecated) <a href="#platform-%eb%8d%b0%ec%9d%b4%ed%84%b0%ec%97%90-gpio-%eb%a7%b5%ed%95%91-deprecated" class="anchor">ğŸ”—</a></h1><p>ì¼ë¶€ ì‹œìŠ¤í…œì—ì„œ ì•„ë˜ì˜ ë§¤í¬ë¡œ í•¨ìˆ˜, APIë¥¼ ì‚¬ìš©í•˜ì—¬ í”Œë«í¼ ë°ì´í„°ì— ì €ì¥í•œ í›„, ì´ë¥¼ lookup í•˜ì—¬ ì‚¬ìš©í•˜ëŠ”ë° ì§€ê¸ˆì€ ì‚¬ìš©í•˜ì§€ ì•ŠëŠ” ë°©ë²•ì´ë‹¤.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c++" data-lang="c++"><span style="display:flex;"><span>GPIO_LOOKUP(chip_label, chip_hwnum, con_id, flag)
</span></span><span style="display:flex;"><span>GPIO_LOOKUP_IDX(chip_label, chip_hwnum, con_id, idx, flags)
</span></span></code></pre></div><p>ì•„ë˜ì™€ ê°™ì´ GPIO Lookup Tableì„ ì •ì˜í•œ í›„ì— ì•„ë˜ì™€ ê°™ì´ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c++" data-lang="c++"><span style="display:flex;"><span><span style="color:#a2f;font-weight:bold">struct</span> <span style="color:#00f">gpiod_lookup_table</span> gpios_table <span style="color:#666">=</span> {
</span></span><span style="display:flex;"><span>    .dev_id <span style="color:#666">=</span> <span style="color:#b44">&#34;foo.0&#34;</span>,
</span></span><span style="display:flex;"><span>    .table <span style="color:#666">=</span> {
</span></span><span style="display:flex;"><span>        GPIO_LOOKUP_IDX(<span style="color:#b44">&#34;gpio.0&#34;</span>, <span style="color:#666">15</span>, <span style="color:#b44">&#34;led&#34;</span>, <span style="color:#666">0</span>, GPIO_ACTIVE_HIGH),
</span></span><span style="display:flex;"><span>        GPIO_LOOKUP_IDX(<span style="color:#b44">&#34;gpio.0&#34;</span>, <span style="color:#666">16</span>, <span style="color:#b44">&#34;led&#34;</span>, <span style="color:#666">1</span>, GPIO_ACTIVE_HIGH),
</span></span><span style="display:flex;"><span>        GPIO_LOOKUP_IDX(<span style="color:#b44">&#34;gpio.0&#34;</span>, <span style="color:#666">17</span>, <span style="color:#b44">&#34;led&#34;</span>, <span style="color:#666">2</span>, GPIO_ACTIVE_HIGH),
</span></span><span style="display:flex;"><span>        GPIO_LOOKUP(<span style="color:#b44">&#34;gpio.0&#34;</span>, <span style="color:#666">1</span>, <span style="color:#b44">&#34;power&#34;</span>, GPIO_ACTIVE_LOW),
</span></span><span style="display:flex;"><span>        { },
</span></span><span style="display:flex;"><span>    },
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>gpiod_add_lookup_table(<span style="color:#666">&amp;</span>gpios_table);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a2f;font-weight:bold">struct</span> <span style="color:#00f">gpio_desc</span> <span style="color:#666">*</span>red, <span style="color:#666">*</span>green, <span style="color:#666">*</span>blue, <span style="color:#666">*</span>power;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>red <span style="color:#666">=</span> gpiod_get_index(dev, <span style="color:#b44">&#34;led&#34;</span>, <span style="color:#666">0</span>, GPIOD_OUT_HIGH);
</span></span><span style="display:flex;"><span>green <span style="color:#666">=</span> gpiod_get_index(dev, <span style="color:#b44">&#34;led&#34;</span>, <span style="color:#666">1</span>, GPIOD_OUT_HIGH);
</span></span><span style="display:flex;"><span>blue <span style="color:#666">=</span> gpiod_get_index(dev, <span style="color:#b44">&#34;led&#34;</span>, <span style="color:#666">2</span>, GPIOD_OUT_HIGH);
</span></span><span style="display:flex;"><span>power <span style="color:#666">=</span> gpiod_get(dev, <span style="color:#b44">&#34;power&#34;</span>, GPIOD_OUT_HIGH);
</span></span></code></pre></div><h1 id="ì¶œì²˜">ì¶œì²˜ <a href="#%ec%b6%9c%ec%b2%98" class="anchor">ğŸ”—</a></h1><ul>
<li><a href="http://jake.dothome.co.kr/gpio-3/" target="_blank" rel="noopener">http://jake.dothome.co.kr/gpio-3/</a></li>
</ul>

    </div>

    
        <div class="tags">
            
                <a href="/tags/gpio">gpio</a>
            
        </div>
    
    
    

</section>


    </main>
    
    <footer id="footer">
    

    <div class="copyright">
    
        Copyright - Sukbeom Kim
    
    </div>

    
</footer>



  </body>
</html>
