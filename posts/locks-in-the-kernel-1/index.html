<!doctype html>
<html
  lang="en-us"
  dir="ltr"
>
  <head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
    <meta charset="utf-8" />
<meta name="language" content="en" />
<meta name="viewport" content="width=device-width" />
<title>
    리눅스 커널 락 종류 (1/5) | 평범한 개발자
</title>
  <meta name="description" content="리눅스 커널에서 사용되는 락의 종류는 다양하다. 학부 시절, ‘뮤텍스는 세마 포어의 카운트가 1인 락’이라는 말도 안되는 내용으로 학교 선배로부터 배웠던 것이 기억난다. 락의 종류별로 쓰임새가 있고 장단점이 있는 것인데, 이 문서에는 커널에서 사용하는 락(lock)의 종류와 각각에 대한 사용 예를 기술하고자 한다." />
<meta property="og:url" content="http://localhost:1313/posts/locks-in-the-kernel-1/">
  <meta property="og:site_name" content="평범한 개발자">
  <meta property="og:title" content="리눅스 커널 락 종류 (1/5)">
  <meta property="og:description" content="리눅스 커널에서 사용되는 락의 종류는 다양하다. 학부 시절, ‘뮤텍스는 세마 포어의 카운트가 1인 락’이라는 말도 안되는 내용으로 학교 선배로부터 배웠던 것이 기억난다. 락의 종류별로 쓰임새가 있고 장단점이 있는 것인데, 이 문서에는 커널에서 사용하는 락(lock)의 종류와 각각에 대한 사용 예를 기술하고자 한다.">
  <meta property="og:locale" content="en_us">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2019-05-28T17:45:51+09:00">
    <meta property="article:modified_time" content="2019-05-28T17:45:51+09:00">
    <meta property="article:tag" content="Mutex">
    <meta property="article:tag" content="Semaphore">
    <meta property="article:tag" content="Spinlock">
    <meta property="article:tag" content="Global Kernel Lock">


  <meta itemprop="name" content="리눅스 커널 락 종류 (1/5)">
  <meta itemprop="description" content="리눅스 커널에서 사용되는 락의 종류는 다양하다. 학부 시절, ‘뮤텍스는 세마 포어의 카운트가 1인 락’이라는 말도 안되는 내용으로 학교 선배로부터 배웠던 것이 기억난다. 락의 종류별로 쓰임새가 있고 장단점이 있는 것인데, 이 문서에는 커널에서 사용하는 락(lock)의 종류와 각각에 대한 사용 예를 기술하고자 한다.">
  <meta itemprop="datePublished" content="2019-05-28T17:45:51+09:00">
  <meta itemprop="dateModified" content="2019-05-28T17:45:51+09:00">
  <meta itemprop="wordCount" content="550">
  <meta itemprop="keywords" content="Mutex,Semaphore,Spinlock,Global Kernel Lock">

  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="리눅스 커널 락 종류 (1/5)">
  <meta name="twitter:description" content="리눅스 커널에서 사용되는 락의 종류는 다양하다. 학부 시절, ‘뮤텍스는 세마 포어의 카운트가 1인 락’이라는 말도 안되는 내용으로 학교 선배로부터 배웠던 것이 기억난다. 락의 종류별로 쓰임새가 있고 장단점이 있는 것인데, 이 문서에는 커널에서 사용하는 락(lock)의 종류와 각각에 대한 사용 예를 기술하고자 한다.">

<link rel="canonical" href="http://localhost:1313/posts/locks-in-the-kernel-1/" />

    <link rel="stylesheet" href="/css/index.css" />


      <script src="/js/main.js" defer></script>
  
  



<script type="application/ld+json">
{
  "@context": "https://schema.org/",
  "@id": "http://localhost:1313/posts/locks-in-the-kernel-1/",
  "@type": "BlogPosting",
  "articleSection": [
    "Computer Science"
  ],
  "author": {
    "@type": "Person",
    "email": "sukbeom.kim@gmail.com",
    "name": "Sukbeom Kim",
    "url": "http://localhost:1313/about/"
  },
  "copyrightNotice": "Sukbeom Kim",
  "datePublished": "2019-05-28",
  "description": "리눅스 커널에서 사용되는 락의 종류는 다양하다. 학부 시절, ‘뮤텍스는 세마 포어의 카운트가 1인 락’이라는 말도 안되는 내용으로 학교 선배로부터 배웠던 것이 기억난다. 락의 종류별로 쓰임새가 있고 장단점이 있는 것인데, 이 문서에는 커널에서 사용하는 락(lock)의 종류와 각각에 대한 사용 예를 기술하고자 한다.",
  "headline": "리눅스 커널 락 종류 (1/5)",
  "isPartOf": {
    "@id": "http://localhost:1313/posts/",
    "@type": "Blog",
    "name": "Posts"
  },
  "keywords": [
    "Global Kernel Lock",
    "Mutex",
    "Semaphore",
    "Spinlock"
  ],
  "mainEntityOfPage": "http://localhost:1313/posts/locks-in-the-kernel-1/",
  "name": "리눅스 커널 락 종류 (1/5)",
  "timeRequired": "PT3M",
  "url": "http://localhost:1313/posts/locks-in-the-kernel-1/",
  "wordCount": 550
}
</script>


  </head>
  <body>
    <div class="container mx-auto flex max-w-prose flex-col space-y-10 p-4 md:p-6">
      <header class="flex flex-row items-center justify-between">
        <div>
  <a id="skip-nav" class="sr-only" href="#maincontent">Skip to main content</a>
  <a class="font-semibold" href="/">평범한 개발자</a>
</div>

  <nav>
    <ul class="flex flex-row items-center justify-end space-x-4">
    <li>
      <a aria-current="true" class="ancestor" href="/posts/">Posts</a
      >
    </li>
    <li>
      <a href="/graph/">Graph</a
      >
    </li>
    <li>
      <a href="/about/">About</a
      >
    </li>
    </ul>
  </nav>


      </header>
      <main class="prose prose-slate relative md:prose-lg prose-h1:text-[2em]" id="maincontent">
        <article class="main">
    <header>
      <h1 class="!mb-1">리눅스 커널 락 종류 (1/5)</h1><div class="flex flex-row items-center space-x-4">
          <time class="text-sm italic opacity-80" datetime="2019-05-28T17:45:51&#43;09:00"
            >May 28, 2019</time
          >
        </div>
    </header>

    <p>리눅스 커널에서 사용되는 락의 종류는 다양하다. 학부 시절, <em>&lsquo;뮤텍스는
세마 포어의 카운트가 1인 락&rsquo;이라는 말도 안되는 내용으로 학교
선배로부터 배웠던 것이 기억난다.</em> 락의 종류별로 쓰임새가 있고 장단점이
있는 것인데, 이 문서에는 커널에서 사용하는 락(lock)의 종류와 각각에
대한 사용 예를 기술하고자 한다.</p>
<p>커널에서 사용 가능한 락은 다음과 같다.</p>
<ol>
<li>스핀락(Spinlock)</li>
<li>뮤텍스(Mutex)</li>
<li>세마포어(Semaphore)</li>
<li>Read/Write Lock(rwlock)</li>
<li>Big Kernel Lock</li>
</ol>
<h2 id="스핀락spinlock" class="scroll-mt-8 group">
  스핀락(Spinlock)
  
    <a href="#%ec%8a%a4%ed%95%80%eb%9d%bdspinlock"
        class="no-underline hidden opacity-50 hover:opacity-100 !text-inherit group-hover:inline-block"
        aria-hidden="true" title="Link to this heading" tabindex="-1">
        <svg
  xmlns="http://www.w3.org/2000/svg"
  width="16"
  height="16"
  fill="none"
  stroke="currentColor"
  stroke-linecap="round"
  stroke-linejoin="round"
  stroke-width="2"
  class="lucide lucide-link w-4 h-4 block"
  viewBox="0 0 24 24"
>
  <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71" />
  <path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71" />
</svg>

    </a>
  
</h2>
<p>커널 락의 주요 타입에는 스핀락(spinlock)과 뮤텍스(mutex)가
있다. 스핀락은 이름 그대로 임계구역(critical section)에 진입이
불가능할 때, 진입기 가능할 때까지 루프를 돌면서 재시도를 하는 방식으로
구현된 락을 가리킨다. 즉, 락을 획득할 때까지 해당 스레드가 계속 돌고
루핑하고 있다는 것을 의미하며, <code>Busy Waiting</code>의 한 종류이다.</p>
<p><code>Busy Waiting</code>이란, <code>Spinning</code>이라고도 하며, 특정
공유 자원에 대해 두 개 이상의 프로세스나 스레드가 그 이용 권한을
획득하고자 하는 동기화 상황에서 권한 획득을 위한 과정에서 일어나는
현상이다. 대부분 스핀락과 동일한 개념으로 사용되지만 엄밀하게
말하자면, 스핀락이 <code>Busy Waiting</code> 개념을 이용하여 구현된 것이다.</p>
<p>다른 락과 비교되는 스핀락의 가장 특징적인 차이점은 <strong>운영 체제의
스케쥴링 지원을 받지 않는다는 점이다.</strong> 즉, 락을 사용하는 스레드에
대한 문맥 교환(Context Switching)이 일어나지 않는다. 따라서 스핀락은
임계 구역에 짧은 시간 안에 진입할 수 있는 경우, 문맥 교환을 제거할 수
있어 효율적이다. 하지만 스핀락이 오랜 시간을 소요한다면 다른 스레드를
실행하지 못하고 대기하게 되어 오히려 비효율적인 결과를 가져온다.</p>
<p>스핀락은 아키텍처별로 어셈블리어로 구현된다. <code>&lt;asm/spinlock.h&gt;</code> 파일에
아키텍처별 코드가 정의돼 있으며, 실제 사용하는 인터페이스는
<code>&lt;linux/spinlock.h&gt;</code>에 들어있다. 이제 실제 코드를 살펴보자.</p>
<h3 id="스핀락-커널-코드" class="scroll-mt-8 group">
  스핀락 커널 코드
  
    <a href="#%ec%8a%a4%ed%95%80%eb%9d%bd-%ec%bb%a4%eb%84%90-%ec%bd%94%eb%93%9c"
        class="no-underline hidden opacity-50 hover:opacity-100 !text-inherit group-hover:inline-block"
        aria-hidden="true" title="Link to this heading" tabindex="-1">
        <svg
  xmlns="http://www.w3.org/2000/svg"
  width="16"
  height="16"
  fill="none"
  stroke="currentColor"
  stroke-linecap="round"
  stroke-linejoin="round"
  stroke-width="2"
  class="lucide lucide-link w-4 h-4 block"
  viewBox="0 0 24 24"
>
  <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71" />
  <path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71" />
</svg>

    </a>
  
</h3>
<figure class="codeblock not-prose relative scroll-mt-8" id="codeblock-01">
  <aside
    class="absolute right-0 top-0 hidden rounded-bl-sm rounded-tr-sm bg-white/10 px-2 py-1 text-white/70 transition-opacity md:inline-block"
  >
    <div class="codeblock-meta flex max-w-xs flex-row items-center space-x-3">
      <div class="small-caps shrink cursor-default truncate font-mono text-xs" aria-hidden="true">
        <span class="relative">c&#43;&#43;</span>
      </div>
      <div>
        <clipboard-copy
          type="button"
          aria-label="Copy code to clipboard"
          title="Copy code to clipboard"
          class="block cursor-pointer transition-colors hover:text-sky-400"
          target="#codeblock-01 code"
        >
          <svg
  xmlns="http://www.w3.org/2000/svg"
  fill="none"
  stroke="currentColor"
  stroke-width="2"
  stroke-linecap="round"
  stroke-linejoin="round"
  class="lucide lucide-clipboard h-4 w-4"
  viewBox="0 0 24 24"
>
  <rect width="8" height="4" x="8" y="2" rx="1" ry="1" />
  <path d="M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2" />
</svg>

        </clipboard-copy>
      </div>
      <div>
        <a
          href="#codeblock-01"
          class="block"
          aria-label="Link to this code block"
          title="Link to this code block"
        >
          <svg
  xmlns="http://www.w3.org/2000/svg"
  width="16"
  height="16"
  fill="none"
  stroke="currentColor"
  stroke-linecap="round"
  stroke-linejoin="round"
  stroke-width="2"
  class="lucide lucide-link w-4 h-4 block"
  viewBox="0 0 24 24"
>
  <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71" />
  <path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71" />
</svg>

        </a>
      </div>
    </div>
  </aside>
  <p class="sr-only">c&#43;&#43; code snippet start</p>
  <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="c1">// 스핀락 선언
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="cp">#define DEFINE_SPINLOCK(x)	spinlock_t x = __SPIN_LOCK_UNLOCKED(x)
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>
</span></span><span class="line"><span class="cl"><span class="c1">// 스핀락을 얻는 함수 spin_lock
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">static</span> <span class="n">__always_inline</span> <span class="kt">void</span> <span class="nf">spin_lock</span><span class="p">(</span><span class="n">spinlock_t</span> <span class="o">*</span><span class="n">lock</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="n">raw_spin_lock</span><span class="p">(</span><span class="o">&amp;</span><span class="n">lock</span><span class="o">-&gt;</span><span class="n">rlock</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// ...
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="cp">#ifndef CONFIG_INLINE_SPIN_LOCK
</span></span></span><span class="line"><span class="cl"><span class="cp"></span><span class="kt">void</span> <span class="n">__lockfunc</span> <span class="nf">_raw_spin_lock</span><span class="p">(</span><span class="n">raw_spinlock_t</span> <span class="o">*</span><span class="n">lock</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="n">__raw_spin_lock</span><span class="p">(</span><span class="n">lock</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="n">EXPORT_SYMBOL</span><span class="p">(</span><span class="n">_raw_spin_lock</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="cp">#endif
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>
</span></span><span class="line"><span class="cl"><span class="c1">// 아래에서도 알 수 있듯이 스핀락을 얻을 때 선점을 비활성화하고 스핀락을 거는 것을 알 수 있다.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">static</span> <span class="kr">inline</span> <span class="kt">void</span> <span class="nf">__raw_spin_lock</span><span class="p">(</span><span class="n">raw_spinlock_t</span> <span class="o">*</span><span class="n">lock</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="n">preempt_disable</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">	<span class="n">spin_acquire</span><span class="p">(</span><span class="o">&amp;</span><span class="n">lock</span><span class="o">-&gt;</span><span class="n">dep_map</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">_RET_IP_</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="n">LOCK_CONTENDED</span><span class="p">(</span><span class="n">lock</span><span class="p">,</span> <span class="n">do_raw_spin_trylock</span><span class="p">,</span> <span class="n">do_raw_spin_lock</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">static</span> <span class="n">__always_inline</span> <span class="kt">void</span> <span class="nf">spin_unlock</span><span class="p">(</span><span class="n">spinlock_t</span> <span class="o">*</span><span class="n">lock</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="n">raw_spin_unlock</span><span class="p">(</span><span class="o">&amp;</span><span class="n">lock</span><span class="o">-&gt;</span><span class="n">rlock</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// 스핀락 초기화 매크로
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="cp">#define spin_lock_init(_lock)				\
</span></span></span><span class="line"><span class="cl"><span class="cp">do {							\
</span></span></span><span class="line"><span class="cl"><span class="cp">	spinlock_check(_lock);				\
</span></span></span><span class="line"><span class="cl"><span class="cp">	raw_spin_lock_init(&amp;(_lock)-&gt;rlock);		\
</span></span></span><span class="line"><span class="cl"><span class="cp">} while (0)</span></span></span></code></pre></div>
  <p class="sr-only">c&#43;&#43; code snippet end</p>

  
</figure>
<p>마지막으로 <code>raw_spin_lock_init</code>을 gtags으로 계속 찾아 들어가면
<code>_raw_spin_lock</code>에 대해서 아래와 같이 <code>spinlock_api_up.h</code>과
<code>spinlock_api_smp.h</code>로 각각 구분되어 정의되어 있는 것을 알 수 있다.</p>
<figure class="codeblock not-prose relative scroll-mt-8" id="codeblock-02">
  <aside
    class="absolute right-0 top-0 hidden rounded-bl-sm rounded-tr-sm bg-white/10 px-2 py-1 text-white/70 transition-opacity md:inline-block"
  >
    <div class="codeblock-meta flex max-w-xs flex-row items-center space-x-3">
      <div class="small-caps shrink cursor-default truncate font-mono text-xs" aria-hidden="true">
        <span class="relative">text</span>
      </div>
      <div>
        <clipboard-copy
          type="button"
          aria-label="Copy code to clipboard"
          title="Copy code to clipboard"
          class="block cursor-pointer transition-colors hover:text-sky-400"
          target="#codeblock-02 code"
        >
          <svg
  xmlns="http://www.w3.org/2000/svg"
  fill="none"
  stroke="currentColor"
  stroke-width="2"
  stroke-linecap="round"
  stroke-linejoin="round"
  class="lucide lucide-clipboard h-4 w-4"
  viewBox="0 0 24 24"
>
  <rect width="8" height="4" x="8" y="2" rx="1" ry="1" />
  <path d="M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2" />
</svg>

        </clipboard-copy>
      </div>
      <div>
        <a
          href="#codeblock-02"
          class="block"
          aria-label="Link to this code block"
          title="Link to this code block"
        >
          <svg
  xmlns="http://www.w3.org/2000/svg"
  width="16"
  height="16"
  fill="none"
  stroke="currentColor"
  stroke-linecap="round"
  stroke-linejoin="round"
  stroke-width="2"
  class="lucide lucide-link w-4 h-4 block"
  viewBox="0 0 24 24"
>
  <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71" />
  <path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71" />
</svg>

        </a>
      </div>
    </div>
  </aside>
  <p class="sr-only">text code snippet start</p>
  <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">/Volumes/KernelHacking/Workspaces/linux-4.20.9/include/linux/spinlock_api_up.h
</span></span><span class="line"><span class="cl">58: #define _raw_spin_lock(
</span></span><span class="line"><span class="cl">/Volumes/KernelHacking/Workspaces/linux-4.20.9/include/linux/spinlock_api_smp.h
</span></span><span class="line"><span class="cl">47: #define _raw_spin_lock(</span></span></code></pre></div>
  <p class="sr-only">text code snippet end</p>

  
</figure>
<p><strong>UP</strong>는 <strong>Uni-Processor</strong>를, <strong>SMP</strong>는 <strong>Symmetric
Multi-Processor</strong>를 의미한다. 각각의 경우에서 스핀락을 사용할 때
생기는 문제점은 다음과 같다.  프로세서가 하나인 UP(Uni-Processor)인
경우, 스핀락으로 인한 성능 오버헤드는 상당하다. 임계영역(Critical
Section) 내에서 락을 잡고 있는 스레드가 선정됐다는 상황을
생각해보자. 이런 상황에서 스케쥴러는 스핀락을 잡고 있는 스레드 외의
다른 모든 스레드를 실행하려할 것이고 스케쥴링된 스레드는 첫 번째
스레드(임계영역을 실행하고 있던)가 쥐고 있는 락을 얻으려 하면서
불필요하게 CPU 사이클을 낭비하게 되는 문제가 발생한다.<!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<p>하지만, SMP(Symmetric Multi-Processor) 환경인 경우 스핀락은 잘 동작한다. <em>UP(Uni-Processor)</em>
환경과 달리 한 스레드가 임계영역 내에서 락을 잡고 있는 상태라도
프로세스가 여러 개이므로 앞서 설명한 상황과 같이, 다른 스레드들이
스케쥴링 되더라도 스핀락 자체가 매우 짧은 시간동안 언락된다면
스케쥴링된 새로운 스레드가 해당 락을 잡게 되어 &lsquo;Uni-Processor&rsquo;처럼
클럭 낭비를 줄일 수 있다.</p>
<h3 id="스핀락과-후반부-처리" class="scroll-mt-8 group">
  스핀락과 후반부 처리
  
    <a href="#%ec%8a%a4%ed%95%80%eb%9d%bd%ea%b3%bc-%ed%9b%84%eb%b0%98%eb%b6%80-%ec%b2%98%eb%a6%ac"
        class="no-underline hidden opacity-50 hover:opacity-100 !text-inherit group-hover:inline-block"
        aria-hidden="true" title="Link to this heading" tabindex="-1">
        <svg
  xmlns="http://www.w3.org/2000/svg"
  width="16"
  height="16"
  fill="none"
  stroke="currentColor"
  stroke-linecap="round"
  stroke-linejoin="round"
  stroke-width="2"
  class="lucide lucide-link w-4 h-4 block"
  viewBox="0 0 24 24"
>
  <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71" />
  <path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71" />
</svg>

    </a>
  
</h3>
<p>스핀락은 인터럽트 핸들러에서 종종 사용된다고 언급했다. 특히, &ldquo;후반부
처리와 지연된 작업&quot;에서 후반부 처리를 진행할 때는 락에 대해 특별한
주의를 기울여야 한다. <code>spin_lock_bh()</code> 또는 <code>spin_unlock_bh()</code> 함수와
같은 경우 지정한 락을 걸고 모든 후반부 처리 작업을 비활성화
시킨다. 이렇게 후반부 처리를 비활성화하는 이유는 <strong>프로세스 컨텍스트
코드를 선점할 수 있기 때문이다.</strong> 만약 후반부 처리와 프로세스 컨텍스트
간에 공유하는 데이터가 있다면 반드시 데이터를 보호하기 위해서 락을
걸고 후반부 처리를 비활성화 시켜야 한다.</p>
<h2 id="출처" class="scroll-mt-8 group">
  출처
  
    <a href="#%ec%b6%9c%ec%b2%98"
        class="no-underline hidden opacity-50 hover:opacity-100 !text-inherit group-hover:inline-block"
        aria-hidden="true" title="Link to this heading" tabindex="-1">
        <svg
  xmlns="http://www.w3.org/2000/svg"
  width="16"
  height="16"
  fill="none"
  stroke="currentColor"
  stroke-linecap="round"
  stroke-linejoin="round"
  stroke-width="2"
  class="lucide lucide-link w-4 h-4 block"
  viewBox="0 0 24 24"
>
  <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71" />
  <path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71" />
</svg>

    </a>
  
</h2>
<ul>
<li><a href="https://ko.wikipedia.org/wiki/%EC%8A%A4%ED%95%80%EB%9D%BD">스핀락 &mdash; 위키피디아</a></li>
<li><a href="https://wiki.openvz.org/Different_kernel_flavors_(UP,_SMP,_ENTERPRISE,_ENTNOSPLIT)">Different kernel flavors (UP, SMP, ENTERPRISE,
ENTNOSPLIT)</a></li>
</ul>
  </article>
    <aside class="not-prose flex flex-col space-y-8 border-t pt-6">
    <section class="flex flex-col space-y-4">
      <h2 class="flex flex-row items-center space-x-2 text-lg font-semibold">
        <svg
  xmlns="http://www.w3.org/2000/svg"
  fill="none"
  stroke="currentColor"
  stroke-linecap="round"
  stroke-linejoin="round"
  stroke-width="2"
  class="lucide lucide-shapes h-4 w-4"
  viewBox="0 0 24 24"
  aria-hidden="true"
>
  <path
    d="M8.3 10a.7.7 0 0 1-.626-1.079L11.4 3a.7.7 0 0 1 1.198-.043L16.3 8.9a.7.7 0 0 1-.572 1.1Z"
  />
  <rect width="7" height="7" x="3" y="14" rx="1" />
  <circle cx="17.5" cy="17.5" r="3.5" />
</svg>

        <span>Categories</span>
      </h2>

      <ul class="ml-6 flex flex-row flex-wrap items-center space-x-2">
          <li>
            <a href="/categories/computer-science/" class="taxonomy category">Computer Science</a>
          </li>
      </ul>
    </section>
    <section class="flex flex-col space-y-4">
      <h2 class="flex flex-row items-center space-x-2 text-lg font-semibold">
        <svg
  xmlns="http://www.w3.org/2000/svg"
  fill="none"
  stroke="currentColor"
  stroke-linecap="round"
  stroke-linejoin="round"
  stroke-width="2"
  class="lucide lucide-tags h-4 w-4"
  viewBox="0 0 24 24"
  aria-hidden="true"
>
  <path d="m15 5 6.3 6.3a2.4 2.4 0 0 1 0 3.4L17 19" />
  <path
    d="M9.586 5.586A2 2 0 0 0 8.172 5H3a1 1 0 0 0-1 1v5.172a2 2 0 0 0 .586 1.414L8.29 18.29a2.426 2.426 0 0 0 3.42 0l3.58-3.58a2.426 2.426 0 0 0 0-3.42z"
  />
  <circle cx="6.5" cy="9.5" r=".5" fill="currentColor" />
</svg>

        <span>Tags</span>
      </h2>

      <ul class="not-prose ml-6 flex flex-row flex-wrap items-center space-x-2">
          <li>
            <a href="/tags/mutex/" class="taxonomy tag">mutex</a>
          </li>
          <li>
            <a href="/tags/semaphore/" class="taxonomy tag">semaphore</a>
          </li>
          <li>
            <a href="/tags/spinlock/" class="taxonomy tag">spinlock</a>
          </li>
          <li>
            <a href="/tags/global-kernel-lock/" class="taxonomy tag">global kernel lock</a>
          </li>
      </ul>
    </section>
    <section class="flex flex-col space-y-4" aria-hidden="true">
      <h2 class="flex flex-row items-center space-x-2 text-lg font-semibold">
        <svg
  xmlns="http://www.w3.org/2000/svg"
  fill="none"
  stroke="currentColor"
  stroke-linecap="round"
  stroke-linejoin="round"
  stroke-width="2"
  class="lucide lucide-chart-network h-4 w-4"
  viewBox="0 0 24 24"
  aria-hidden="true"
>
  <path
    d="m13.11 7.664 1.78 2.672M14.162 12.788l-3.324 1.424M20 4l-6.06 1.515M3 3v16a2 2 0 0 0 2 2h16"
  />
  <circle cx="12" cy="6" r="2" />
  <circle cx="16" cy="12" r="2" />
  <circle cx="9" cy="15" r="2" />
</svg>

        <span>Graph</span>
      </h2>

      <content-network-graph
  class="h-64 ml-6"
  data-endpoint="/graph/index.json"
  page="/posts/locks-in-the-kernel-1/"
></content-network-graph>

    </section>
</aside>


      </main>
      <footer class="mt-20 border-t border-neutral-100 pt-2 text-xs">
        <section class="items-top flex flex-row justify-between opacity-70">
  <div class="flex flex-col space-y-2">
      <p>Copyright &copy; 2024, Sukbeom Kim.</p>

  </div>
    <div>
      <a
        href="https://github.com/michenriksen/hugo-theme-til"
        title="Today I Learned &#8212; A Hugo theme by Michael Henriksen"
        data-theme-version="0.6.0"
        >theme: til</a
      >
    </div>
</section>

      </footer>
    </div>
    
  </body>
</html>
